{% load staticfiles %}

{% block content %}

<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="msapplication-tap-highlight" content="no">
  <meta name="description" content="Materialize is a Material Design Admin Template,It&#39;s modern, responsive and based on Material Design by Google. ">
  <meta name="keywords" content="materialize, admin template, dashboard template, flat admin template, responsive admin template,">
<title>Inicio de Sesión</title>


  <!-- Favicons-->
  <!-- For iPhone -->
  <meta name="msapplication-TileColor" content="#00bcd4">
  <meta name="msapplication-TileImage" content="images/favicon/mstile-144x144.png">
  <!-- For Windows Phone -->


  <!-- CORE CSS-->

  <link href="{% static 'css/materialize1.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
  <link href="{% static 'css/stylelogin.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
    <link href="{% static 'css/custom-style.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
  <link href="{% static 'css/style-fullscreen.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
  <link href="{% static 'css/page-center.css' %}" type="text/css" rel="stylesheet" media="screen,projection">

  <link href="{% static 'css/prism.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
  <link href="{% static 'css/perfect-scrollbar.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
  <link rel="stylesheet" href="{% static 'css/font-awesome.css' %}">

 <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>

<body class="cyan loaded">
  <div id="loader-wrapper">
      <div id="loader"></div>
      <div class="loader-section section-left"></div>
      <div class="loader-section section-right"></div>
  </div>


  <div id="login-page" class="row">
    <div class="col s12 z-depth-4 card-panel">
      <form class="login-form">
        <div class="row">
          <div class="input-field col s12 center">
           <img src= "{% static 'images/login-logo.png' %}" alt="" class="circle responsive-img valign profile-image-login">
            <p class="center login-form-text">Login PikQuick</p>
          </div>
        </div>
        <div class="row margin">

          <div class="input-field col s12" >
            <input name="username" id="id_username" type="text">
              <label for="username" class="center-align"><i class="fa fa-user fa-2x"></i>   Username
</label>
          </div>
        </div>
        <div class="row margin">
          <div class="input-field col s12">
            <input name="password" id="id_password1" type="password">
            <label for="password" class=""><i class="fa fa-unlock-alt fa-2x"></i>     Password</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12 m12 l12  login-text">
              <input type="checkbox" id="remember-me">
              <label for="remember-me">Recordarme</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12">
            <a class="btn waves-effect waves-light col s12" id="log-in">Login</a>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6 m6 l6">
            <p class="margin medium-small"><a href="{% url 'pikquick:nuevo_usuario' %}">Registrate!</a></p>
          </div>
          <!--<div class="input-field col s6 m6 l6">
              <p class="margin right-align medium-small"><a href="">Forgot password ?</a></p>
          </div>-->




                     <!-- <fb:login-button scope="public_profile,email" onlogin="checkLoginState();">
</fb:login-button>
<div id="status">
</div>

BOTON DE FACEBOOK HABILITAR CUANDO TENGAMOS URL
-->


        </div>

      </form>
    </div>
  </div>


    {% endblock %}
{% block scripts %}


  <script type="text/javascript" src="{% static 'js/jquery-1.11.2.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/materialize1.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/prism.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/perfect-scrollbar.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/plugins.js' %}"></script>






    <script>
  function statusChangeCallback(response) {
    console.log('statusChangeCallback');
    console.log(response);

    if (response.status === 'connected') {
      testAPI();
    } else if (response.status === 'not_authorized') {
      document.getElementById('status').innerHTML = 'Please log ' +
        'into this app.';
    } else {

      document.getElementById('status').innerHTML = 'Please log ' +
        'into Facebook.';
    }
  }


  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  }

  window.fbAsyncInit = function() {
  FB.init({
    appId      : '{957207560987249}',
    cookie     : true,  // enable cookies to allow the server to access
                        // the session
    xfbml      : true,  // parse social plugins on this page
    version    : 'v2.2' // use version 2.2
  });


  FB.getLoginStatus(function(response) {
    statusChangeCallback(response);
  });

  };

  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));


  function testAPI() {
    console.log('Welcome!  Fetching your information.... ');
    FB.api('/me', function(response) {
      console.log('Successful login for: ' + response.name);
      document.getElementById('status').innerHTML =
        'Thanks for logging in, ' + response.name + '!';
    });
  }
</script>



<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '957207560987249',
      xfbml      : true,
      version    : 'v2.4'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>



<script>
    $('.button-collapse').sideNav();
    $(document).ready(function(){
        $('.modal-trigger').leanModal();
    });
    $('#log-in').click(function() {
        console.log("logueando por ajax");
        var data={
            csrfmiddlewaretoken: '{{ csrf_token }}',
            username:$('input:text[name=username]').val(),
            password:$('input:password[name=password]').val(),
        }

        $.ajax({
            type: "POST",
            url: "{% url 'pikquick:ingreso_usuario' %}",
            data: data,
            statusCode: {
                200: function(){
                    window.location.assign("{% url 'pikquick:inicio' %}");
                },
                203: function(){
                    Materialize.toast('Usuario o contraseña incorrectos/inexistentes', 2000);
                    $('#id_username').value("");
                    $('#id_password1').value("");
                },

                204: function(){
                    Materialize.toast('Usuario ya existente', 2000);
                },
            },
        });
    });

</script>
{% endblock %}



<div class="hiddendiv common"></div></body></html>


